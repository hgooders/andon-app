<!DOCTYPE html>
<html>
<head>
    <title>Andon Summary</title>
    <meta http-equiv="refresh" content="10">
    <style>
        table {
            border-collapse: collapse;
            width: 80%;
            margin: 20px auto;
        }

        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }

        th {
            background-color: #f2f2f2;
        }

        .gold {
            background-color: gold;
        }

        .silver {
            background-color: silver;
        }

        .bronze {
            background-color: #cd7f32;
        }

        .stop-alert {
            display: block;
            width: 200px;
            margin: 20px auto;
            padding: 10px;
            font-size: 16px;
            background-color: #f44336;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body {% if flashing %}style="background-color: red;"{% endif %}>

    <h1 style="text-align:center;">Andon Summary</h1>

    <table>
        <tr>
            <th>Timestamp</th>
            <th>Reason</th>
            <th>Name</th>
            <th>Stopped Time (minutes)</th>
        </tr>
        {% for entry in entries %}
        <tr>
            <td>{{ entry.timestamp }}</td>
            <td>{{ entry.reason }}</td>
            <td>{{ entry.name }}</td>
            <td>{{ entry.stopped_time }}</td>
        </tr>
        {% endfor %}
    </table>

    <h2 style="text-align:center;">Top 3 Downtime Reasons</h2>
    <table>
        <tr>
            <th>Rank</th>
            <th>Reason</th>
            <th>Total Minutes</th>
        </tr>
        {% for reason, minutes in top_reasons %}
        <tr class="{% if loop.index == 1 %}gold{% elif loop.index == 2 %}silver{% elif loop.index == 3 %}bronze{% endif %}">
            <td>{{ loop.index }}</td>
            <td>{{ reason }}</td>
            <td>{{ minutes }}</td>
        </tr>
        {% endfor %}
    </table>

    <h2 style="text-align:center;">Line Status</h2>
    <p style="text-align:center;">Stopped: {{ percent_stopped }}%</p>
    <p style="text-align:center;">Running: {{ percent_running }}%</p>

    {% if flashing %}
    <form method="POST" action="{{ url_for('stop_alert') }}">
        <button class="stop-alert">Stop Alert</button>
    </form>
    {% endif %}

    <p style="text-align:center;"><a href="{{ url_for('home') }}">Back to Home</a></p>

</body>
</html>

